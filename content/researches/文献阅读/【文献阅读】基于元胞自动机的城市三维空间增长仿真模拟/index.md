+++
draft = false
date = 2025-07-26T16:51:50+08:00
title = "【文献阅读】基于元胞自动机的城市三维空间增长仿真模拟"
authors = ["RONGHUA LI"]
tags = ["CA", "城市三维扩张"]
categories = ["文献阅读"]
series = ["城市扩张模拟"]

+++

# 文献信息

| 第一作者：秦静         | 单位：中国科学院地理科学与资源研究所 |
| :--------------------- | :----------------------------------- |
| 通讯作者：方创琳       | 单位：中国科学院地理科学与资源研究所 |
| 期刊：地球信息科学学报 | 发表时间：2013 年 10 月              |

# 研究背景

## **元胞自动机（CA）模型的特点**

元胞自动机（CA）模型的特点是局部规则（local rules）导致系统全局变化（global change），很好地体现了城市的自组织性特点。

## **城市 CA 模型在三维扩张模拟较少**

目前，城市 CA 模型在结构上、逻辑上和表现形 式上多是二维空间，对城市立体空间扩展的研究较少。

Bengguigui等的城市空间三维元胞自动机（3DCA）模型，用不同参数模拟了城市发展的不同阶段并作出合理解释，但是并没有对模型进行三维的可视化，而是使用颜色来区分不同楼层的高度，这种表达有失精确性和直观性，并且其在建立城市模型时**将元胞空间即城市发展的空间视为是同质的**，这与真实城市（不同区域具有异质性）相悖[19]。

> [19] Benguigui L, Czamanski D, Roth R. Modeling cities in 3D: A cellular automaton approach[J]. Environment and Planning B: Planning and Design, 2008,35(3):413-430.

张乐珊对 Bengguigui 模型 进行了三维显示，并结合多主体模型对英国东南部 沿海 Cromer 镇进行了城市三维空间增长模拟，但是其**并没有对 Bengguigui 模型进行实质的改进**[11]。

> [11] 张乐珊.基于元胞自动机和 VR-GIS 技术的城市空间增 长 三 维 动 态 模 拟 及 应 用 研 究 [D]. 青 岛: 中 国 海 洋 大 学, 2010.

# 研究目的

本文借鉴经典的城市空间增长模拟方法，以城市发展的自组织性为理论依据，**改进了 Bengguigui 等的城市空间增长三维元胞自动机（3DCA）模型**， 在其模型的基础上分别加入**中心距离及交通距离评价因子**构建新的模型；

使用 **NetLogo 3D 建模工具**进行城市三维空间增长仿真模拟实验，用二维和三维两种视图显示实验结果，进一步探讨了三维城市空间增长的规律。

# 城市空间增长三维元胞自动机模型

## 三维元胞自动机定义

三维元胞空间可以用底面的正方形**格网和高度**来表示。元胞空间的高度取值大于或等于建筑物的最高高度，其中**建 筑物高度以楼层数表示**，最高楼层设定为 30 层，该数值可以根据实际情况设定。

任一立体元胞的索引可以表示为 $Cell_{x,y,h}$ ，其中，$(x,y)$ 为平面坐标，$h$ 为楼层数值。

元胞的邻域定义为 **Moore** 邻域，即与该元胞直接相邻的 8 个元胞单元。

在三维元胞空间中，每一个立体元胞可以表示一个单体建筑或一个同质的建筑群块。

## 城市空间增长模型的构建（建模依据）

城市三维空间增长模型，是以城市发展的自组织理论为理论基础，其建模的依据：

（1）城市空间系统具有与生命个体类似的特征，在模型中可将土地单元（元胞单元）类比为城市生命系统的细胞，**每个土地单元都具有生长的潜力**。
（2）城市三维空间形态的变化具有**空间上不连续性和时间上不一致性**。
（3）城市三维空间形态主要由不同形式的**三维建筑集簇**组成。三维建筑集簇可以定义为一定数量的空间上相邻接的具有**相似高度的建筑单元聚集体**。
（4）城市三维空间的发展演变是**跳跃式**的过程。三维建筑据集簇最初开始在某个特定位置形成，发展一段时间后，可能又会在新的位置形成建筑聚集簇，故城市的发展可以看做是**不断形成三维建筑聚集簇**的过程。
（5）距离**城市中心**越近，地块区位越好，人口密度越高，城市中建筑发展为高层的概率越高。
（6）距离**交通线路**越近，地块区位越好，地皮价格越高，城市中建筑发展为高层的概率越高。

其中，前 4 项为 Benguigui 城市空间增长模型的假设条件，它**将城市空间视为无差异的地理表面**， 即在一块没有区位差异的土地上建设一个城市，在其模型中**所有的元胞单元均为同质的，具有相同的发展概率**，没有考虑不同的元胞单元之间的异质性。

本文建模时**考虑到不同元胞单元之间的异质性**，增加了中心距离（距离城市中心的距离）和交通距离两个影响因素，以求更加精确地模拟真实城市 空间增长过程。

> 本研究的改进点：用中心距离和交通距离两个影响因素来考虑到不同元胞单元之间的异质性。

## 模型的评价因子（建模因子）

参考了城市经济学、城市地理学基本理论和市场规律，并借鉴了 Bengguigui 城市空间增长三维元胞自动机模型（3DCA）模型，城市发展密度元胞自动机模型[26]、约束性单元自动演化 CA 模型[27-28]等二维城市空间扩展模型。

> [26] 黎夏,叶嘉安.基于元胞自动机的城市发展密度模拟[J]. 地理科学,2006,26(2):165-172.
>
> [27] 黎夏,叶嘉安.约束性单元自动演化 CA 模型及可持续城市发展形态的模拟[J].地理学报,1999,54(4):289-298.
>
> [28] Li Xia, Yeh A G O. Modelling sustainable urban develop- ment by the integration of constrained cellular automata and GIS[J]. International Journal of Geographical Infor- mation Science, 2000, 14(2):131-152.

模型共设置 6 个评价因子：初始覆盖率（IC），惯性因子（IF），邻域交互因子（IN），噪声因子（NS），中心距离因子（CD），交通距离因子 （TD）。

三维城市空间增长模型公式如下所示。
$$
3DCA = f (IC, IF, IN, NS, CD, TD)
$$
（1）初始覆盖率（IC）：城市发展的最初形态。
（2）惯性因子（IF）：表达了在特定的地理区域中，城市空间增长过程的**连续性**和自组织性。**如果某个建筑单元在某一时刻发生增长，那么这个建筑单元在下一时刻将具有继续增长的惯性**。惯性因子是对经济地理学中规模经济效应的部分反映。
（3）邻域交互因子（IN）：表达了土地单元邻域内建筑开发活动对该土地单元的影响作用， **如果某土地单元邻域内建筑开发达到一定比例，那么该土地单元在下一时刻被开发的概率将会大大增加**。邻域交互因子是城市发展的自组织集聚效应的表现，是人们交往活动需要、规模效益要求等多种因素的综合反映。
（4）噪声因子（NS）：反映了城市发展中的不确定因素或人为干预因素，可以用来表示**城市发展政策、城市规划决策等对城市发展的影响**。噪声因子在模型中是**不可控的随机参数**，与其他因素和过程不相关。
（5）中心距离因子（CD）：表达了**人口密度**对城市建筑增长的影响，距离城市中心越近，人口密度越高，对建筑物容积率的要求也越高，建筑物增长为高层的概率也越高。
（6）交通距离因子（TD）：该因子表达了交通因素对城市建筑增长的影响，**距离主要交通路线越近**，地区的通达性越好，其邻近的**土地单元被开发的概率也越高**。

## 评价函数及规则

### 评价因子取值

在城市仿真模型中，**初始覆盖率 IC 是一个概率值，可由用户自行设定**，模拟的初始化阶段，将按照用户设定的概率随机向三维元胞空间添加高度为 1 的建筑物（模型中建筑物的初始高度设置为 1 层）。

其他 5 个评价因子 $(IF, IN, NS, CD, TD)$ 的取值均为二进制值 0 或 1。

元胞单元 $Cell_{x,y,h,t}$ 在 $t$ 时刻评价因子取值的计算方法：

**（1）惯性参数（ $IF$ ）**

如果 t = 0 ，惯性值取值为 1 的概率取决于初始覆盖率。
$$
F(x, y, h, 0) = 
\begin{cases}
1, & \text{if } p = IC \\
0, & \text{if } p = 1 - IC
\end{cases}
$$
当 $t ≠ 0$ 时，惯性参数的取值取决于 $t - 1$ 时刻元胞的建筑高度变化 $Δh$ 。
$$
IF(x, y, h, t) = 
\begin{cases}
1, & \text{if } \Delta h(x, y, t - 1) \neq 0, \, p = i \\
0, & \text{if } \Delta h(x, y, t - 1) = 0
\end{cases}
$$
如果 $Δh ≠ 0$ ，惯性参数以 $p = i$ 的概率赋值为 1；如果 $Δh = 0$ ，惯性参数取值为 0。

**（2）邻域交互参数（$IN$）**

元胞邻域取 Moore 邻域，设定一个阈值 $n(0≤n≤8)$ ， 通过比较 $t - 1$ 时刻邻域内出现增长 ($Δh = 1$) 的元胞 数量与阈值 $n$ 的大小来决定邻域交互参数的取值， 如果大于或者等于阈值，则 $IN$ 取值为 1，否则取值为 0。
$$
IN(x, y, h, t) = 
\begin{cases}
1, & \text{if } \sum \Delta h(x, y, t - 1) \geq n,\quad 0 ≤ n ≤ 8 \\
0, & \text{if } \sum \Delta h(x, y, t - 1) < n,\quad 0 ≤ n ≤ 8
\end{cases}
$$
**（3）噪声参数（$NS$）**

噪声参数在模型中与其他参数和过程相互独立，它的取值是由噪声概率 $η$ 决定。

在模型初始化阶段设置噪声参数后，整个运算过程中噪声参数不受其他因子变化的影响，噪声参数取值为 1 的概率为 $η$ ，取值为 0 的概率为 $1 - η$ 。
$$
NS(x, y, t) = 
\begin{cases}
1, &  p = \eta \\
0, &  p = 1 - \eta
\end{cases}
$$
**（4）中心距离参数（ $CD$ ）**

人口密度随着远离市中心而衰减， 可利用密度的衰减函数来表达这种关系[29] ： $Den_i = Ae^{-βx_i}$，这里 $Den_i$为密度，$x_i$ 为离中心的距离，$A$ 和 $β$ 为衰减函数的参数。

> [29] Clark C. Urban population densities[J]. Journal of the Royal Statistical Society, Series A (General), 1951,114(4): 490-496.

中心距离参数值取 1 的概率参照密度衰减函数定义为 $p = Ae^{-β(x^2+y^2)^{1/2}}$ ，其中，元胞距离中心的距离为 $(x^2+y^2)^{1/2}$，$A$ 和 $β$ 为常数参数。
$$
CD(x, y, t) = 
\begin{cases}
1, &  p = A e^{-\beta (x^2 + y^2)^{1/2}} \\
0, &  p = 1 - A e^{-\beta (x^2 + y^2)^{1/2}}
\end{cases}
$$
**（5）交通距离参数（ $TD$）**

 元胞单元随着距离交通道路的距离增加，参数值取 1 的概率呈线性衰减，即元胞值取为 1 的概率为 $p = (z - d_{min})/(d_{max} - d_{min}) $，其中，z 为元胞距交通道路的距离，$z = (x^2 + y^2)^{1/2} $，$d_{min}$ 与 $d_{max}$ 分别为距离交通道路的最近距离和最远距离。
$$
TD(x, y, t) = 
\begin{cases}
1, & p = \frac{d_{max} - z}{d_{max} - d_{min}} \\
0, & \text{otherwise}
\end{cases}
$$

> 原论文公式错误❌

### 评价函数

本文中元胞状态转换规则是由元胞生长潜力评价函数 $f$ 决定，函数 $f$ 是一个**布尔离散函数**，由上述 6 个参数的取值决定。

元胞单元 $Cell_{x,y,h,t}$ 在 $t$ 时刻的评价函数 $f$ ：
$$
f_0(x, y, h, t) = IF(x, y, h, t) + IN(x, y, h, t) + NS(x, y, t) \\
f(x, y, h, t) = 
\begin{cases}
1, & \text{if } f_0(x, y, h, t) \geq 2 \\
0, & \text{if } f_0(x, y, h, t) < 2
\end{cases}
$$

$$
f_1(x, y, h, t) = IF(x, y, h, t) + IN(x, y, h, t) + NS(x, y, t) + CD(x, y, t) \\

f(x, y, h, t) = 
\begin{cases}
1, & \text{if } f_1(x, y, h, t) \geq 3 \\
0, & \text{if } f_1(x, y, h, t) < 3
\end{cases}
$$

$$
f_2(x, y, h, t) = IF(x, y, h, t) + IN(x, y, h, t) + NS(x, y, t) + TD(x, y, t)\\

f(x, y, h, t) = 
\begin{cases}
1, & \text{if } f_2(x, y, h, t) \geq 3 \\
0, & \text{if } f_2(x, y, h, t) < 3
\end{cases}
$$

公式（8）为城市每个土地单元均为同质的情况下，元胞状态转换规则，当 $IF ，IN ，NS$  3 个 参数中有 2 个或者 2 个以上时取值为 1，则评价函数 $f$  取值为 1，表明城市会进行新的增长，其余情况 $f(x, y, h, t) =0$，即城市不作改变保持现状 。

公式（9）和（10）分别为加入中心距离参数与交通距离参数后，城市土地单元异质的情况下，元胞状态转换规则。在公式（8）中，当 $IF ，IN ，NS ，CD$  4 个 参数中有 3 个或者 3 个以上同时取值为 1，则评价函数 $f$  取值为 1，其余情况 $f(x, y, h, t) =0$；在公式（9）中当 $IF，IN，NS，TD$  4 个参数中有 3 个或者 3 个以上同时取值为 1，则评价函数 $f$  取值为 1，其余情况 $f(x, y, h, t) =0$。

## 基于评价结果计算建筑高度

如果元胞单元 $Cell_{x,y,h,t}$ 的生长潜力函数值为 1，那么高度 $h$ 会在前一时刻高度的基础上增加 $Δh$ 。$Δh$ 的值可以根据实际需要取一层或者多层， 本文中取 $Δh = 1$。

建筑高度计算公式如下:
$$
h(x, y, t) = h(x, y, t - 1) + f(x, y, t - 1)\\
h(x, y, t) \leq h_{\max}, \; t \leq T
$$
其中，$h_{max}$ 为建筑增长的最高高度限制，本文取 $h_{max}=30$ ，当建筑高度增长达到 30 时，则该建筑停止增长，$T$ 为模型运行的时间，即模型达到稳定状态时系统运行的时间。
