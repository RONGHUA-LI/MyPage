+++
draft = false
date = 2025-07-25T10:10:49+08:00
title = "建站记录"
description = ""
slug = ""
authors = ["RONGHUA LI"]
tags = ["hugo"]
categories = ["前端技术"]
externalLink = ""
series = ["Blog养成记"]

+++

# 研究

- ```yaml
  # 用于构建和部署Hugo网站到GitHub Pages的工作流程
  name: Deploy Hugo site to Pages
  
  on:
    # 在目标为默认分支的推送上运行
    push:
      branches:
        - main
  
    # 允许您手动从“Actions”标签运行此工作流程
    workflow_dispatch:
  
  # 设置GITHUB_TOKEN的权限，以允许部署到GitHub Pages
  permissions:
    contents: read
    pages: write
    id-token: write
  
  # 仅允许一个并发部署，跳过在进行中的运行与最新排队的运行之间排队的运行。
  # 但是，请不要取消进行中的运行，因为我们希望这些生产部署能够完成。
  concurrency:
    group: "pages"
    cancel-in-progress: false
  
  # 默认使用bash
  defaults:
    run:
      shell: bash
  
  jobs:
    # 构建作业
    build:
      runs-on: ubuntu-latest
      env:
        HUGO_VERSION: 0.148.1
      steps:
        - name: 安装Hugo CLI
          run: |
            wget -O ${{ runner.temp }}/hugo.deb https://github.com/gohugoio/hugo/releases/download/v${HUGO_VERSION}/hugo_extended_${HUGO_VERSION}_linux-amd64.deb \
            && sudo dpkg -i ${{ runner.temp }}/hugo.deb          
        - name: 安装Dart Sass
          run: sudo snap install dart-sass
        - name: 检出
          uses: actions/checkout@v4
          with:
            submodules: recursive
            fetch-depth: 0
        - name: 设置Pages
          id: pages
          uses: actions/configure-pages@v5
        - name: 安装Node.js依赖
          run: "[[ -f package-lock.json || -f npm-shrinkwrap.json ]] && npm ci || true"
        - name: 使用Hugo构建
          env:
            # 为了与Hugo模块的最大向后兼容性
            HUGO_ENVIRONMENT: production
            HUGO_ENV: production
          run: |
            hugo \
              --gc \
              --minify \
              --baseURL "${{ steps.pages.outputs.base_url }}/"          
        - name: 上传构建产物
          uses: actions/upload-pages-artifact@v3
          with:
            path: ./public
  
    # 部署作业
    deploy:
      environment:
        name: github-pages
        url: ${{ steps.deployment.outputs.page_url }}
      runs-on: ubuntu-latest
      needs: build
      steps:
        - name: 部署到GitHub Pages
          id: deployment
          uses: actions/deploy-pages@v4
  ```
  
- 步骤7

  使用类似"Add workflow"的提交消息将更改提交到本地仓库，并推送到GitHub。

  ```powershell
  # 添加远程仓库, origin作为别名
  git remote add origin https://github.io/<username>.github.io
  
  git commit  -m 'Add workflow'
  git push origin main
  ```

- 步骤8

  从GitHub的主菜单中选择**Actions**。你会看到如下内容：

  ![屏幕截图](https://hugo.opendocs.io/hosting-and-deployment/hosting-on-github/gh-pages-3.png)

  当GitHub完成构建和部署您的站点后，状态指示器的颜色将变为蓝色。

  将来，每当您从本地仓库推送更改时，GitHub都会重新构建您的站点并部署更改。

上面的示例工作流程包括以下步骤，通常需要10-15秒：

```yaml
- name: 安装Dart Sass
  run: sudo snap install dart-sass
```

如果您的站点、主题和模块不使用[Dart Sass](https://hugo.opendocs.io/hugo-pipes/transpile-sass-to-css/#dart-sass)转译Sass到CSS，您可以删除此步骤。
